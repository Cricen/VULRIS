<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><meta name="author" content="Scott G"/><title>VULRIS documentation.docx</title><style type="text/css"><!--
  .s1 { font-weight: normal; font-size: 8pt; }
 .s2 { font-weight: normal; font-size: 21pt; }
 p { font-family: serif; font-weight: normal; font-size: 11pt; }
 h2 { color: #5B9BD4; font-weight: bold; font-size: 12pt; }
 .s3 { font-weight: normal; font-size: 11pt; }
 h1 { font-weight: bold; font-size: 13pt; }
 .s4 { color: #0462C1; font-family: serif; font-weight: normal; font-size: 11pt; }
 .s5 { color: #0462C1; font-family: serif; font-weight: normal; text-decoration: underline; font-size: 11pt; }
 .s6 { color: #1154CC; font-family: serif; font-weight: normal; text-decoration: underline; font-size: 11pt; }
 .s7 { font-family: serif; font-weight: normal; font-size: 11pt; }
 .h3 { color: #060; font-family: serif; font-weight: bold; font-size: 11pt; }
 .s8 { color: #1154CC; font-family: serif; font-weight: normal; font-size: 11pt; }
  -->
</style></head><body><p class="s1">Scott Greenwald</p><p><span><IMG width="494" height="232" src="VULRISdocumentation-3/Image_001.png"/></span></p><p class="s1">Leon Corrales Morales</p><p class="s2">VULRIS Administration Guide</p><p>The following details how to prepare, install, and use VULRIS. General Linux knowledge may be required.</p><h2>Contents</h2><p class="s3">System Requirements ............................................................................................................ 2</p><p class="s3">Software ............................................................................................................................. 2</p><p class="s3">Hardware ............................................................................................................................ 2</p><p class="s3">Setup...................................................................................................................................... 2</p><p class="s3">CentOS ............................................................................................................................... 2</p><p class="s3">Risu .................................................................................................................................... 2</p><p class="s3">Nessus................................................................................................................................ 2</p><p class="s3">Apache ............................................................................................................................... 3</p><p class="s3">MySQL................................................................................................................................ 3</p><p class="s3">PHP .................................................................................................................................... 4</p><p class="s3">Apache/RISU Configuration ................................................................................................ 4</p><p class="s3">VULRIS............................................................................................................................... 4</p><p class="s3">SSL Setup........................................................................................................................... 5</p><p class="s3">Risu Modification................................................................................................................. 7</p><p class="s3">Execution ............................................................................................................................... 7</p><p class="s3">Risu Configuration .............................................................................................................. 7</p><p class="s3">Database creation............................................................................................................... 8</p><p class="s3">Setting Permissions ............................................................................................................ 8</p><p class="s3">Firewall Setup ..................................................................................................................... 8</p><p class="s3">Run a Nessus scan ............................................................................................................. 8</p><p class="s3">Add a Nessus scan to VULRIS ........................................................................................... 9</p><p class="s3">Report Generation .............................................................................................................. 9</p><p class="s1">VULRIS Administration Guide                                                                                                                           2</p><h1>SYSTEM REQUIREMENTS</h1><h2>Software</h2><p>CentOS (tested on CentOS 6.3, 6.4)</p><h2>Hardware</h2><p>CentOS supported hardware (list: <a href="http://wiki.centos.org/AdditionalResources/HardwareList" class="s4"> </a><a href="http://wiki.centos.org/AdditionalResources/HardwareList" class="s5">http://wiki.centos.org/AdditionalResources/HardwareList</a>)<br/>-OR-<br/>VMware vSphere supported hardware (list: <a href="http://www.vmware.com/resources/compatibility" class="s5">http://www.vmware.com/resources/compatibility</a>)</p><h1>SETUP</h1><h2>CentOS</h2><p>Download and install CentOS (<a href="http://www.centos.org/" class="s6">http://www.centos.org/</a>)</p><h2>Risu</h2><p>Enter the following commands in a terminal (as superuser/root) to install Risu and its dependencies:</p><p class="s7"># yum install mysql<span class="h3">-</span>devel gcc</p><p class="s7"># yum install ruby</p><p class="s7"># yum install apr-devel autoconf automake httpd-devel libcurl-devel</p><p class="s7"># yum install ruby-rdoc ruby-devel</p><p class="s7"># yum install rubygems</p><p class="s7"># gem update --system</p><p class="s7"># yum install ImageMagick ImageMagick-devel libxml2-devel sqlite-devel libxslt-devel</p><p class="s7"># gem install rmagick libxml-ruby sqlite3 mysql</p><p class="s7"># gem install risu --v 1.5.3</p><h2>Nessus</h2><p>Nessus is a scanner that is used to scan an entire network for vulnerabilities.</p><p class="s1">May 15, 2013</p><p class="s1">VULRIS Administration Guide                                                                                                                           3</p><p>Install Nessus: <a href="http://www.tenable.com/products/nessus/select-your-operating-system" class="s6">http://www.tenable.com/products/nessus/select-your-operating-system</a><br/>Choose the version compatible with Red Hat ES 6 (64 bits) / CentOS 6 / Oracle Linux 6<br/>The filename should look like this: Nessus-5.2.0-es6.x86_64.rpm<br/>Once downloaded, open the directory containing Nessus in a Linux terminal and type:</p><p class="s7"># rpm -ivh Nessus-5.0.2-es6.x86_64.rpm</p><p>Setup user credentials by entering the command:</p><p class="s7"># /opt/nessus/sbin/nessus-adduser</p><p>Register for the Nessus HomeFeeed: <a href="http://www.tenable.com/products/nessus/nessus-homefeed" class="s8"> </a><a href="http://www.tenable.com/products/nessus/nessus-homefeed" class="s6">http://www.tenable.com/products/nessus/nessus-</a><a href="http://www.tenable.com/products/nessus/nessus-homefeed" class="s8"> </a><a href="http://www.tenable.com/products/nessus/nessus-homefeed" class="s6">homefeed</a><br/>Check your email for the activation key and enter it after this command:</p><p class="s7"># /opt/nessus/bin/nessus-fetch --register &lt;your key # here&gt;</p><p>Enter the command:</p><p class="s7">#/etc/init.d/nessusd start</p><p>Refer to the Nessus 5.0 Instllation and Configuration Guide for more details:<br/><a href="http://static.tenable.com/documentation/nessus_5.0_installation_guide.pdf" class="s6">http://static.tenable.com/documentation/nessus_5.0_installation_guide.pdf</a></p><h2>Apache</h2><p>Enter the following commands to install the Apache web server:</p><p class="s7"># yum install httpd</p><p class="s7"># service httpd start</p><h2>MySQL</h2><p>Enter the following commands to install the MySQL database:</p><p class="s7"># yum install mysql-server</p><p class="s7"># service mysqld start</p><p>Setup MySQL with the following command:</p><p class="s1">May 15, 2013</p><p class="s1">VULRIS Administration Guide                                                                                                                           4</p><p class="s7"># /usr/bin/mysql_secure_installation</p><p>Follow the steps to set a root password, disable anonymous users, disable remote login, disable test database, and reload privilege tables.</p><h2>PHP</h2><p>Enter the command:</p><p class="s7"># yum install php php-mysql</p><p>Finally, enter the commands below to start HTTP and MySQL during startup:</p><p class="s7"># chkconfig httpd on</p><p class="s7"># chkconfig mysqld on</p><h2>Apache/RISU Configuration</h2><p>The general idea here is get the passenger / mod_passenger install. The methods for accomplishing this may change. The first thing to do is to add the stealthymonkey rpm.<br/><span style=" font-family: serif; font-weight: normal; font-size: 9pt;"># rpm --import http://passenger.stealthymonkeys.com/RPM-GPG-KEY-stealthymonkeys.asc</span><br/><span style=" font-family: serif; font-weight: normal; font-size: 9pt;"># yum install http://passenger.stealthymonkeys.com/rhel/6/passenger-release.noarch.rpm</span></p><p class="s7"># yum install mod_passenger</p><p>If libev fails then download the rpm here:<br/>http://pkgs.org/centos-6-rhel-6/epel-x86_64/libev-4.03-3.el6.x86_64.rpm.html<br/>If fastthread is required then enter:</p><p class="s7"># gem install fastthread</p><p>If rack is required then enter:</p><p class="s7"># gem install rack</p><h2>VULRIS</h2><p>Copy the contents of VULRIS to /var/www/html.<br/>Modify db.php at /var/www/html/lib/Database/ with your database username and password. Modify config.php at /var/www/html/lib/nmap/ with your database username and password.</p><p class="s1">May 15, 2013</p><p class="s1">VULRIS Administration Guide                                                                                                                           5</p><p>Modify config.php at /var/www/html/lib/nessus/ with your database username and password.<br/>Modify config.php at /var/www/html/lib/Databases/login/ with your database username and password.</p><h2>SSL Setup</h2><p>Follow the directions below to set up VULRIS over https. For more details, refer to <a href="http://wiki.centos.org/HowTos/Https" class="s5">http://wiki.centos.org/HowTos/Https</a>.<br/>For an SSL encrypted web server you will need a few things. Depending on your install you may or may not have OpenSSL and mod_ssl, Apache&#39;s interface to OpenSSL. Use yum to get them if you need them.</p><p class="s7"># yum install mod_ssl openssl</p><p>Yum will either tell you they are installed or will install them for you.<br/>Using OpenSSL we will generate a self-signed certificate. If you are using this on a production server you are probably likely to want a key from Trusted Certificate Authority, but if you are<br/>just using this on a personal site or for testing purposes a self-signed certificate is fine. To create the key you will need to be root so you can either su to root or use sudo in front of the commands.<br/>Generate private key:</p><p class="s7"># openssl genrsa -out ca.key 1024</p><p>Generate CSR:</p><p class="s7"># openssl req -new -key ca.key -out ca.csr</p><p>Generate Self Signed Key:</p><p class="s7"># openssl x509 -req -days 365 -in ca.csr -signkey ca.key -out ca.crt</p><p>Copy the files to the correct locations:</p><p class="s7"># cp ca.crt /etc/pki/tls/certs</p><p class="s7"># cp ca.key /etc/pki/tls/private/ca.key</p><p class="s7"># cp ca.csr /etc/pki/tls/private/ca.csr</p><p>WARNING: Make sure that you copy the files and do not move them if you use SELinux. Apache will complain about missing certificate files otherwise, as it cannot read them because the<br/>certificate files do not have the right SELinux context.</p><p class="s1">May 15, 2013</p><p class="s1">VULRIS Administration Guide                                                                                                                           6</p><p>If you have moved the files and not copied them, you can use the following command to correct the SELinux contexts on those files, as the correct context definitions for /etc/pki/* come with the bundled SELinux policy.</p><p class="s7"># restorecon -RvF /etc/pki</p><p>Then we need to update the Apache SSL configuration file:</p><p class="s7"># vi +/SSLCertificateFile /etc/httpd/conf.d/ssl.conf</p><p>Change the paths to match where the Key file is stored. If you&#39;ve used the method above it will be:</p><p class="s7"># SSLCertificateFile /etc/pki/tls/certs/ca.crt</p><p>Then set the correct path for the Certificate Key File a few lines below. If you&#39;ve followed the instructions above it is:</p><p class="s7"># SSLCertificateKeyFile /etc/pki/tls/private/ca.key</p><p>Quit and save the file and then restart Apache:</p><p class="s7"># /etc/init.d/httpd restart</p><p>All being well you should now be able to connect over https to your server and see a default Centos page. As the certificate is self signed browsers will generally ask you whether you want to accept the certificate. Firefox 3 won&#39;t let you connect at all but you can override this.<br/>Just as you set VirtualHosts for http on port 80 so you do for https on port 443. A typical<br/>VirtualHost for a site on port 80 looks like this:</p><p class="s7">&lt;VirtualHost *:80&gt;</p><p class="s7">&lt;Directory /var/www/vhosts/yoursite.com/httpdocs&gt; AllowOverride All</p><p class="s7">&lt;/Directory&gt;</p><p class="s7">DocumentRoot /var/www/vhosts/yoursite.com/httpdocs</p><p class="s7">ServerName yoursite.com</p><p class="s7">&lt;/VirtualHost&gt;</p><p>To add a sister site on port 443 you need to add the following at the top of your file:</p><p class="s7">NameVirtualHost *:443</p><p>and then a VirtualHost record something like this:</p><p class="s1">May 15, 2013</p><p class="s1">VULRIS Administration Guide                                                                                                                           7</p><p class="s7">&lt;VirtualHost *:443&gt; SSLEngine on</p><p class="s7">SSLCertificateFile /etc/pki/tls/certs/ca.crt</p><p class="s7">SSLCertificateKeyFile /etc/pki/tls/private/ca.key</p><p class="s7">&lt;Directory /var/www/vhosts/yoursite.com/httpsdocs&gt; AllowOverride All</p><p class="s7">&lt;/Directory&gt;</p><p class="s7">DocumentRoot /var/www/vhosts/yoursite.com/httpsdocs</p><p class="s7">ServerName yoursite.com</p><p class="s7">&lt;/VirtualHost&gt;</p><p>Restart Apache again using:</p><p class="s7"># /etc/init.d/httpd restart</p><h2>Risu Modification</h2><p>Copy the contents of Models and Templates folders to the Risu directory and overwrite all. Risu folder: <span class="s7">/usr/lib64/ruby/gems/1.8/gems/risu-1.5.3/lib/risu/</span></p><h1>EXECUTION</h1><h2>Risu Configuration</h2><p>Enter the following commands in a terminal (as superuser/root) to configure Risu:</p><p class="s7"># risu --create-config</p><p>This will create a configuration file, risu.cfg, in your current directory. Fill in your database information and other information you want to appear on generated reports.</p><p class="s7">report:</p><p class="s7">author: [your name] title: [your title] company: [your company]</p><p class="s7">classification: [classification type]</p><p class="s7">database:</p><p class="s7">adapter: mysql2</p><p class="s7">database: [database name]</p><p class="s7">port: 3306</p><p class="s7">username: [database username]</p><p class="s7">password: [database password]</p><p class="s1">May 15, 2013</p><p class="s1">VULRIS Administration Guide                                                                                                                           8</p><h2>Database creation</h2><p>Locate the directory with the VULRIS_schema.sql file. Enter the following commands in a terminal to set up a database with the proper tables:</p><p class="s7"># mysql -u root -p &lt; VULRIS_schema.sq<span class="s3">l</span></p><p class="s7"># mysql -u root -p &lt; users.sq<span class="s3">l</span></p><h2>Setting Permissions</h2><p>Navigate to the root of your web server in a Terminal:</p><p class="s7"># cd /var/www/html</p><p>Change the Reports folder’s group to apache:</p><p class="s7"># chgrp apache Reports</p><h2>Firewall Setup</h2><p>From the CentOS desktop, choose the System menu from the top bar. Select Administration, then Firewall. In the Other Ports section, modify the firewall settings as shown below to allow secure (https, port 443) traffic and open the :<br/><span><IMG width="533" height="371" src="VULRISdocumentation-3/Image_002.jpg"/></span></p><h2>Run a Nessus scan</h2><p class="s1">May 15, 2013</p><p class="s1">VULRIS Administration Guide                                                                                                                           9</p><p>Navigate to VULRIS by entering your server&#39;s IP address in your web browser. If you are viewing this guide on the server you may enter https://localhost<br/>Log in and choose the Launch Nessus option.<br/>Run a scan of your network. Refer to Nessus documentation for details:<br/><a href="http://www.tenable.com/products/nessus/documentation" class="s5">http://www.tenable.com/products/nessus/documentation</a></p><h2>Add a Nessus scan to VULRIS</h2><p>Click the Choose File button and pick an exported .nessus scan file. After clicking Process File, the Nessus file will be uploaded, parsed, and added to the MySQL database.</p><h2>Report Generation</h2><p>Choose the Reports Control menu option in VULRIS. Choose a report to generate and click the Report button. Your report will be generated and a PDF will appear shortly. Certain reports may take longer to generate (e.g. graphs, historical, executive summary) depending on the size of<br/>your network scan.</p><p class="s1">May 15, 2013</p></body></html>
